<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magicbot - Onlayn Do'kon</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* === UMUMIY STILLAR === */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
         :root {
            --primary: #3a86ff;
            --secondary: #8338ec;
            --accent: #ff006e;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --success: #38b000;
            --warning: #ff9e00;
            --danger: #ff3b30;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--dark);
            max-width: 500px;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            min-height: 100vh;
            position: relative;
        }
        /* Kirish sahifasi */
        
        .login-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .login-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .login-header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .login-form {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .login-form .form-group {
            margin-bottom: 20px;
        }
        
        .login-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .login-form input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 16px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .login-form input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .login-form small {
            display: block;
            margin-top: 5px;
            font-size: 0.85rem;
            opacity: 0.8;
        }
        
        .login-footer {
            margin-top: 30px;
            text-align: center;
            opacity: 0.8;
            font-size: 0.9rem;
        }
        /* Header */
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 800;
            letter-spacing: 1px;
        }
        
        .logo span {
            color: var(--accent);
        }
        
        .user-greeting {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }
        /* Search Bar */
        
        .search-container {
            padding: 15px;
            background-color: white;
            display: none;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            background-color: var(--light-gray);
            border-radius: 50px;
            padding: 10px 20px;
        }
        
        .search-box i {
            color: var(--gray);
            margin-right: 10px;
        }
        
        .search-box input {
            border: none;
            background: transparent;
            width: 100%;
            font-size: 16px;
            outline: none;
        }
        /* Navigation */
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08);
            z-index: 200;
            max-width: 500px;
            margin: 0 auto;
            display: none;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--gray);
            text-decoration: none;
            font-size: 12px;
            transition: all 0.3s;
            cursor: pointer;
            padding: 5px 10px;
        }
        
        .nav-item i {
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .nav-item.active {
            color: var(--primary);
        }
        
        .nav-item:hover {
            color: var(--primary);
        }
        /* Main Content */
        
        .content {
            padding-bottom: 70px;
            min-height: calc(100vh - 140px);
        }
        /* Sahifa o'tish animatsiyasi */
        
        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        .page.active {
            display: block;
        }
        /* Home Page */
        
        .categories {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 15px;
        }
        
        .category-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .category-card i {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 10px;
        }
        /* Catalog Page */
        
        .catalog-container {
            padding: 15px;
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .product-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .product-image {
            height: 150px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            background-size: cover;
            background-position: center;
        }
        
        .product-info {
            padding: 12px;
        }
        
        .product-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 15px;
            height: 40px;
            overflow: hidden;
        }
        
        .product-price {
            color: var(--primary);
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .product-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .btn {
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2a75ff;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--light-gray);
        }
        
        .btn-warning {
            background-color: var(--warning);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        /* Cart Page */
        
        .cart-item {
            display: flex;
            background-color: white;
            margin: 10px;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .cart-item-image {
            width: 80px;
            height: 80px;
            background-color: var(--light-gray);
            border-radius: 8px;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: cover;
            background-position: center;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .cart-item-actions {
            display: flex;
            align-items: center;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--light-gray);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .quantity {
            margin: 0 10px;
            font-weight: 600;
        }
        
        .cart-total {
            background-color: white;
            margin: 10px;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            font-weight: 700;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
        }
        /* Profile Page */
        
        .profile-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
        }
        
        .avatar {
            width: 70px;
            height: 70px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            margin-right: 15px;
        }
        
        .user-info h2 {
            margin-bottom: 5px;
        }
        
        .user-info p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .section {
            background-color: white;
            margin: 10px;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            font-size: 16px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            font-weight: 600;
            color: var(--dark);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .section-title i {
            margin-right: 10px;
            color: var(--primary);
        }
        
        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .menu-item:last-child {
            border-bottom: none;
        }
        
        .menu-item:hover {
            background-color: var(--light-gray);
            padding-left: 10px;
            padding-right: 10px;
            margin: 0 -10px;
            border-radius: 5px;
        }
        
        .menu-item div {
            display: flex;
            align-items: center;
        }
        
        .menu-item i {
            margin-right: 10px;
            width: 20px;
            color: var(--gray);
        }
        
        .badge {
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        /* Back Button */
        
        .back-button {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            color: var(--primary);
            cursor: pointer;
            background-color: white;
            border-bottom: 1px solid var(--light-gray);
            font-weight: 600;
        }
        
        .back-button i {
            margin-right: 8px;
        }
        /* Empty States */
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }
        
        .empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        /* Address Items */
        
        .address-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            margin-bottom: 10px;
            background-color: white;
        }
        
        .address-icon {
            font-size: 20px;
            margin-right: 12px;
            width: 24px;
            text-align: center;
            color: var(--primary);
        }
        
        .address-info {
            flex: 1;
        }
        
        .address-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .address-details {
            font-size: 14px;
            color: var(--gray);
        }
        /* Loyallik Page */
        
        .loyalty-content {
            text-align: center;
            padding: 20px;
        }
        
        .loyalty-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }
        
        .loyalty-points {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .loyalty-subtitle {
            color: var(--gray);
            margin-bottom: 25px;
        }
        
        .loyalty-info {
            background-color: #f9f9f9;
            border-radius: 12px;
            padding: 20px;
            text-align: left;
        }
        
        .loyalty-info-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .loyalty-list {
            padding-left: 20px;
            color: var(--gray);
        }
        
        .loyalty-list li {
            margin-bottom: 10px;
        }
        /* Product Detail Page */
        
        .product-detail-container {
            background-color: white;
            min-height: 100vh;
        }
        
        .product-detail-image {
            height: 300px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: cover;
            background-position: center;
            color: var(--gray);
            font-size: 48px;
        }
        
        .product-detail-info {
            padding: 20px;
        }
        
        .product-detail-info h2 {
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .product-detail-price {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .product-detail-category {
            display: inline-block;
            background-color: var(--light-gray);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 20px;
        }
        
        .product-detail-description {
            margin-bottom: 30px;
        }
        
        .product-detail-description h3 {
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .product-detail-description p {
            line-height: 1.6;
            color: var(--gray);
        }
        
        .product-detail-actions {
            display: flex;
            gap: 10px;
        }
        
        .product-detail-actions .btn {
            flex: 1;
            padding: 12px;
            font-size: 16px;
        }
        /* Checkout Page */
        
        .checkout-total {
            font-size: 20px;
            font-weight: 700;
            padding: 15px;
            border-top: 2px solid var(--light-gray);
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }
        
        .checkout-user-info {
            padding: 10px 0;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        .payment-methods {
            display: grid;
            gap: 10px;
        }
        
        .payment-method {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-method:hover {
            border-color: var(--primary);
        }
        
        .payment-method input {
            margin-right: 10px;
        }
        /* Order Confirmation Page */
        
        .order-confirmation {
            min-height: 100vh;
            background-color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            text-align: center;
        }
        
        .confirmation-icon {
            font-size: 80px;
            color: var(--success);
            margin-bottom: 20px;
        }
        
        .confirmation-icon i {
            animation: bounce 1s;
        }
        
        @keyframes bounce {
            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-30px);
            }
            60% {
                transform: translateY(-15px);
            }
        }
        
        .order-confirmation h2 {
            margin-bottom: 15px;
            color: var(--success);
        }
        
        .confirmation-text {
            font-size: 16px;
            color: var(--gray);
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .order-summary {
            width: 100%;
            background-color: #f9f9f9;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: left;
        }
        
        .order-summary h3 {
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .summary-item:last-child {
            border-bottom: none;
        }
        
        .confirmation-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
        }
        
        .confirmation-actions .btn {
            padding: 12px;
            font-size: 16px;
        }
        /* Modallar */
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 20px;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--primary);
            outline: none;
        }
        /* Xabarlar */
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1000;
            max-width: 300px;
        }
        
        .notification.error {
            background-color: var(--danger);
        }
        
        .notification.warning {
            background-color: var(--warning);
        }
        /* Responsive */
        
        @media (max-width: 500px) {
            .categories {
                grid-template-columns: 1fr;
            }
            .product-grid {
                grid-template-columns: 1fr;
            }
            .product-detail-actions {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <!-- Kirish sahifasi (Ism kiritish) -->
    <div class="page active" id="loginPage">
        <div class="login-container">
            <div class="login-header">
                <h1><i class="fas fa-store"></i> Magicbot</h1>
                <p>Onlayn do'koningizga xush kelibsiz</p>
            </div>

            <div class="login-form">
                <div class="form-group">
                    <label for="userName">Ismingizni kiriting:</label>
                    <input type="text" id="userName" placeholder="Misol: Aziz" required>
                    <small>Sizga murojaat qilishimiz uchun ismingiz kerak</small>
                </div>

                <button class="btn btn-primary" onclick="startApp()">
                    <i class="fas fa-sign-in-alt"></i> Do'konga kirish
                </button>
            </div>

            <div class="login-footer">
                <p><i class="fas fa-info-circle"></i> Ismingiz faqat siz bilan muloqot uchun ishlatiladi</p>
            </div>
        </div>
    </div>

    <!-- Header -->
    <div class="header" id="mainHeader">
        <div class="logo">Magic<span>bot</span>¬Æ</div>
        <div class="user-greeting" id="userGreeting">Salom, <span id="currentUserName">Foydalanuvchi</span></div>
    </div>

    <!-- Search Bar -->
    <div class="search-container" id="searchContainer">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Izlash...">
        </div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Bosh sahifa -->
        <div class="page" id="homePage">
            <div class="categories">
                <div class="category-card" onclick="showCategory('Oyoq kiyimlar')">
                    <i class="fas fa-shoe-prints"></i>
                    <h3>Oyoq kiyimlar</h3>
                </div>
                <div class="category-card" onclick="showCategory('Kiyimlar')">
                    <i class="fas fa-tshirt"></i>
                    <h3>Kiyimlar</h3>
                </div>
                <div class="category-card" onclick="showCategory('Uy-ro\'zg\'or')">
                    <i class="fas fa-home"></i>
                    <h3>Uy-ro'zg'or</h3>
                </div>
                <div class="category-card" onclick="showCategory('Elektronika')">
                    <i class="fas fa-laptop"></i>
                    <h3>Elektronika</h3>
                </div>
                <div class="category-card" onclick="showCategory('Go\'zallik')">
                    <i class="fas fa-heartbeat"></i>
                    <h3>Go'zallik</h3>
                </div>
                <div class="category-card" onclick="showCategory('mmmmmm')">
                    <i class="fas fa-heartbeat"></i>
                    <h3>sssss</h3>
                </div>
                <div class="category-card" onclick="showCategory('Barcha kategoriyalar')">
                    <i class="fas fa-th-large"></i>
                    <h3>Barcha kategoriyalar</h3>
                </div>
            </div>
        </div>

        <!-- Katalog sahifasi -->
        <div class="page" id="catalogPage">
            <div class="catalog-container">
                <h2 style="margin: 15px;" id="catalogTitle">Barcha mahsulotlar</h2>
                <div class="product-grid" id="productGrid">
                    <!-- Mahsulotlar JavaScript orqali qo'shiladi -->
                </div>
            </div>
        </div>

        <!-- Savat sahifasi -->
        <div class="page" id="cartPage">
            <div id="cartItems">
                <!-- Savatdagi mahsulotlar JavaScript orqali qo'shiladi -->
            </div>
            <div class="cart-total">
                <span>Jami:</span>
                <span id="totalPrice">0 so'm</span>
            </div>
            <div style="padding: 20px;">
                <button class="btn btn-primary" style="width: 100%; padding: 15px;" onclick="showCheckoutPage()">
                    <i class="fas fa-shopping-bag"></i> Buyurtma berish
                </button>
            </div>
        </div>

        <!-- Profil sahifasi -->
        <div class="page" id="profilePage">
            <div class="profile-header">
                <div class="avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-info">
                    <h2 id="profileUserName">Foydalanuvchi</h2>
                    <p id="profileUserPhone">Telefon raqam kiritilmagan</p>
                </div>
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-shopping-bag"></i> XARIDLAR</div>
                <div class="menu-item" onclick="showOrders()">
                    <div><i class="fas fa-cog"></i> Mening buyurtmalarim</div>
                    <div class="badge" id="ordersCount">0</div>
                </div>
                <div class="menu-item" onclick="showFavorites()">
                    <div><i class="fas fa-heart"></i> Sevimlilar</div>
                    <div class="badge" id="favoritesCount">0</div>
                </div>
                <div class="menu-item" onclick="showViewed()">
                    <div><i class="fas fa-eye"></i> Ko'rilgan mahsulotlar</div>
                    <div class="badge" id="viewedCount">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-user-circle"></i> SHAXSIY KABINET</div>
                <div class="menu-item" onclick="editProfile()">
                    <div><i class="fas fa-user-edit"></i> Mening profilim</div>
                </div>
                <div class="menu-item" onclick="showAddresses()">
                    <div><i class="fas fa-map-marker-alt"></i> Mening manzillarim</div>
                </div>
                <div class="menu-item" onclick="showLoyalty()">
                    <div><i class="fas fa-chart-line"></i> Loyallik dasturi</div>
                    <div class="badge" id="loyaltyPoints">0</div>
                </div>
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-cog"></i> SOZLAMALAR</div>
                <div class="menu-item" onclick="changeName()">
                    <div><i class="fas fa-exchange-alt"></i> Ismni o'zgartirish</div>
                </div>
                <div class="menu-item" onclick="logout()">
                    <div><i class="fas fa-sign-out-alt"></i> Chiqish</div>
                </div>
            </div>
        </div>

        <!-- Buyurtmalar sahifasi -->
        <div class="page" id="ordersPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>
            <div class="section">
                <div class="section-title">Mening buyurtmalarim</div>
                <div id="ordersList">
                    <div class="empty-state">
                        <div class="empty-icon">üì¶</div>
                        <div>Sizda hali buyurtmalar yo'q</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sevimlilar sahifasi -->
        <div class="page" id="favoritesPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>
            <div class="section">
                <div class="section-title">Sevimlilar</div>
                <div id="favoritesList">
                    <div class="empty-state">
                        <div class="empty-icon">‚ù§Ô∏è</div>
                        <div>Sevimlilarda hali hech narsa yo'q</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ko'rilganlar sahifasi -->
        <div class="page" id="viewedPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>
            <div class="section">
                <div class="section-title">Ko'rilgan mahsulotlar</div>
                <div id="viewedList">
                    <div class="empty-state">
                        <div class="empty-icon">üëÅÔ∏è</div>
                        <div>Siz hali hech qanday mahsulotni ko'rmagansiz</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manzillar sahifasi -->
        <div class="page" id="addressesPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>
            <div class="section">
                <div class="section-title">Mening manzillarim</div>
                <div id="addressesList">
                    <div class="empty-state">
                        <div class="empty-icon">üìç</div>
                        <div>Sizda hali manzillar yo'q</div>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="openAddAddress()">
                    <i class="fas fa-plus"></i> Yangi manzil qo'shish
                </button>
            </div>
        </div>

        <!-- Loyallik sahifasi -->
        <div class="page" id="loyaltyPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>
            <div class="section">
                <div class="section-title">Loyallik dasturi</div>
                <div class="loyalty-content">
                    <div class="loyalty-icon">üèÜ</div>
                    <div class="loyalty-points" id="loyaltyPointsDisplay">0 ball</div>
                    <div class="loyalty-subtitle">Ball qanday to'planadi:</div>
                    <div class="loyalty-info">
                        <ul class="loyalty-list">
                            <li>Har 10 000 so'm xarid uchun - 1 ball</li>
                            <li>Do'stni taklif qilish - 50 ball</li>
                            <li>Har oy yangi mahsulot xaridi - 20 ball</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mahsulot tafsilotlari sahifasi -->
        <div class="page" id="productDetailPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>
            <div class="product-detail-container">
                <div class="product-detail-image" id="productDetailImage">
                    <!-- Rasm JavaScript orqali yuklanadi -->
                </div>
                <div class="product-detail-info">
                    <h2 id="productDetailName">Mahsulot nomi</h2>
                    <div class="product-detail-price" id="productDetailPrice">0 so'm</div>
                    <div class="product-detail-category" id="productDetailCategory">Kategoriya</div>

                    <div class="product-detail-description">
                        <h3>Ta'rif</h3>
                        <p id="productDetailDesc">Mahsulot ta'rifi...</p>
                    </div>

                    <div class="product-detail-actions">
                        <button class="btn btn-primary" onclick="addToCartFromDetail()">
                            <i class="fas fa-cart-plus"></i> Savatchaga qo'shish
                        </button>
                        <button class="btn btn-outline" onclick="addToFavorites()">
                            <i class="fas fa-heart"></i> Sevimlilarga
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buyurtma berish sahifasi -->
        <div class="page" id="checkoutPage">
            <div class="back-button" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Orqaga
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-shopping-cart"></i> Savatdagi mahsulotlar</div>
                <div id="checkoutItems">
                    <!-- Mahsulotlar JavaScript orqali ko'rsatiladi -->
                </div>
                <div class="checkout-total">
                    <span>Umumiy summa:</span>
                    <span id="checkoutTotal">0 so'm</span>
                </div>
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-user"></i> Ma'lumotlaringiz</div>
                <div class="checkout-user-info">
                    <div class="info-row">
                        <span>Ism:</span>
                        <span id="checkoutUserName">Foydalanuvchi</span>
                    </div>
                    <div class="info-row">
                        <span>Telefon:</span>
                        <span id="checkoutUserPhone">+998</span>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-map-marker-alt"></i> Yetkazib berish manzili</div>
                <div class="form-group">
                    <label>Viloyat</label>
                    <select id="regionSelect" onchange="updateDistricts()">
                        <option value="">Viloyatni tanlang</option>
                        <!-- JavaScript orqali to'ldiriladi -->
                    </select>
                </div>
                <div class="form-group">
                    <label>Tuman/Shahar</label>
                    <select id="districtSelect" disabled>
                        <option value="">Avval viloyatni tanlang</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>To'liq manzil</label>
                    <textarea id="fullAddress" rows="3" placeholder="Ko'cha, uy, kvartira..."></textarea>
                </div>
                <div class="form-group">
                    <label>Telefon raqamingiz</label>
                    <input type="tel" id="userPhone" placeholder="+998901234567" required>
                </div>
                <div class="form-group">
                    <label>Izoh (ixtiyoriy)</label>
                    <textarea id="orderComment" rows="2" placeholder="Qo'shimcha izohlar..."></textarea>
                </div>
            </div>

            <div class="section">
                <div class="section-title"><i class="fas fa-credit-card"></i> To'lov usuli</div>
                <div class="payment-methods">
                    <label class="payment-method">
                        <input type="radio" name="payment" value="cash" checked>
                        <span>Naqd pul</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment" value="card">
                        <span>Karta orqali</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment" value="click">
                        <span>Click</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment" value="payme">
                        <span>Payme</span>
                    </label>
                </div>
            </div>

            <div style="padding: 20px;">
                <button class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 18px;" onclick="submitOrder()">
                    <i class="fas fa-check-circle"></i> BUYURTMA TASDIQLASH
                </button>
            </div>
        </div>

        <!-- Buyurtma tasdiq sahifasi -->
        <div class="page" id="orderConfirmationPage">
            <div class="order-confirmation">
                <div class="confirmation-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2>Buyurtmangiz qabul qilindi!</h2>
                <p class="confirmation-text">
                    Hurmatli <span id="confirmationUserName"></span>, buyurtmangiz muvaffaqiyatli qabul qilindi. Tez orada operatorlarimiz siz bilan bog'lanadi.
                </p>

                <div class="order-summary">
                    <h3>Buyurtma ma'lumotlari:</h3>
                    <div class="summary-item">
                        <span>Buyurtma raqami:</span>
                        <span id="orderNumber">#0001</span>
                    </div>
                    <div class="summary-item">
                        <span>Umumiy summa:</span>
                        <span id="summaryTotal">0 so'm</span>
                    </div>
                    <div class="summary-item">
                        <span>Yetkazib berish:</span>
                        <span id="summaryAddress">Manzil</span>
                    </div>
                </div>

                <div class="confirmation-actions">
                    <button class="btn btn-primary" onclick="continueShopping()">
                        <i class="fas fa-shopping-cart"></i> Xaridni davom ettirish
                    </button>
                    <button class="btn btn-outline" onclick="viewOrders()">
                        <i class="fas fa-list"></i> Buyurtmalarimni ko'rish
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pastki navigatsiya -->
    <div class="bottom-nav" id="bottomNav">
        <a class="nav-item active" onclick="showHome()">
            <i class="fas fa-home"></i>
            <span>Bosh sahifa</span>
        </a>
        <a class="nav-item" onclick="showCatalog()">
            <i class="fas fa-th-large"></i>
            <span>Katalog</span>
        </a>
        <a class="nav-item" onclick="showCart()">
            <i class="fas fa-shopping-cart"></i>
            <span>Savatcha</span>
        </a>
        <a class="nav-item" onclick="showProfile()">
            <i class="fas fa-user"></i>
            <span>Profil</span>
        </a>
    </div>

    <!-- Profilni tahrirlash modali -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Profilni tahrirlash</h2>
                <span class="close-modal" onclick="closeModal('profileModal')">&times;</span>
            </div>
            <div class="form-group">
                <label>Telefon raqam</label>
                <input type="text" id="editPhone" placeholder="+998901234567">
            </div>
            <div class="form-group">
                <label>Email (ixtiyoriy)</label>
                <input type="email" id="editEmail" placeholder="email@example.com">
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="saveProfile()">Saqlash</button>
        </div>
    </div>

    <!-- Ism o'zgartirish modali -->
    <div class="modal" id="nameModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ismni o'zgartirish</h2>
                <span class="close-modal" onclick="closeModal('nameModal')">&times;</span>
            </div>
            <div class="form-group">
                <label>Yangi ism</label>
                <input type="text" id="newUserName" placeholder="Yangi ismingiz">
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="saveNewName()">Saqlash</button>
        </div>
    </div>

    <!-- Manzil qo'shish modali -->
    <div class="modal" id="addressModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Yangi manzil qo'shish</h2>
                <span class="close-modal" onclick="closeModal('addressModal')">&times;</span>
            </div>
            <div class="form-group">
                <label>Manzil nomi</label>
                <input type="text" id="addressName" placeholder="Uy, Ish, Ota-ona uyi">
            </div>
            <div class="form-group">
                <label>Viloyat</label>
                <select id="modalRegionSelect" onchange="updateModalDistricts()">
                    <option value="">Viloyatni tanlang</option>
                </select>
            </div>
            <div class="form-group">
                <label>Tuman/Shahar</label>
                <select id="modalDistrictSelect" disabled>
                    <option value="">Avval viloyatni tanlang</option>
                </select>
            </div>
            <div class="form-group">
                <label>To'liq manzil</label>
                <textarea id="modalFullAddress" rows="3" placeholder="Ko'cha, uy, kvartira..."></textarea>
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="saveAddress()">Saqlash</button>
        </div>
    </div>

    <!-- Xabarlar -->
    <div class="notification" id="notification">
        <span id="notificationText">Amal muvaffaqiyatli bajarildi!</span>
    </div>

    <script>
        // ===== KONFIGURATSIYA =====
        const TELEGRAM_BOT_TOKEN = "7692859653:AAE_8ddxOhqdjiqV8nJMQCp1ud46jvSGlDE";
        const TELEGRAM_CHAT_ID = "8074394669";

        // ===== GLOBAL O'ZGARUVCHILAR =====
        let cart = [];
        let currentUser = null;
        let currentCategory = 'all';
        let lastPage = 'homePage';
        let currentOrder = null;

        // Viloyat va tumanlar ma'lumotlari
        const regions = {
            "Toshkent": ["Olmazor", "Bektemir", "Mirobod", "Mirzo Ulug'bek", "Sergeli", "Shayxontohur", "Chilonzor", "Yashnobod", "Yunusobod", "Yakkasaroy", "Uchtepa"],
            "Andijon": ["Andijon shahri", "Xonobod", "Shahrixon", "Asaka", "Qo'rg'ontepa", "Baliqchi", "Oltinko'l", "Jalaquduq", "Izboskan", "Paxtaobod", "Marhamat", "Buloqboshi", "Boz", "Ulug'nor"],
            "Farg'ona": ["Farg'ona shahri", "Marg'ilon", "Qo'qon", "Quvasoy", "Beshariq", "Bog'dod", "Buvayda", "Dang'ara", "Yozyovon", "Oltiariq", "Qo'shtepa", "Rishton", "So'x", "Toshloq", "Uchko'prik", "O'zbekiston"],
            "Namangan": ["Namangan shahri", "Chortoq", "Chust", "Kosonsoy", "Mingbuloq", "Norin", "Pop", "To'raqo'rg'on", "Uchqo'rg'on", "Uychi", "Yangiqo'rg'on"],
            "Samarqand": ["Samarqand shahri", "Bulung'ur", "Ishtixon", "Jomboy", "Kattaqo'rg'on", "Narpay", "Nurobod", "Oqdaryo", "Paxtachi", "Payariq", "Pastdarg'om", "Qo'shrabot", "Toyloq", "Urgut"],
            "Buxoro": ["Buxoro shahri", "Olot", "G'ijduvon", "Jondor", "Kogon", "Qorako'l", "Qorovulbozor", "Peshku", "Romitan", "Shofirkon", "Vobkent"],
            "Xorazm": ["Urganch shahri", "Xiva", "Bog'ot", "Gurlan", "Qo'shko'pir", "Shovot", "Tuproqqal'a", "Xonqa", "Xazorasp", "Yangiariq", "Yangibozor"],
            "Navoiy": ["Navoiy shahri", "Zarafshon", "Karmana", "Konimex", "Navbahor", "Nurota", "Tomdi", "Uchquduq"],
            "Qashqadaryo": ["Qarshi shahri", "Shahrisabz", "Chiroqchi", "Dehqonobod", "G'uzor", "Kasbi", "Kitob", "Koson", "Mirishkor", "Muborak", "Nishon", "Qamashi", "Yakkabog'"],
            "Surxondaryo": ["Termiz shahri", "Bandixon", "Boysun", "Denov", "Jarqo'rg'on", "Muzrabot", "Oltinsoy", "Qiziriq", "Qumqo'rg'on", "Sariosiyo", "Sherobod", "Sho'rchi", "Uzun"],
            "Jizzax": ["Jizzax shahri", "Arnasoy", "Baxmal", "Do'stlik", "Forish", "G'allaorol", "Sharof Rashidov", "Mirzacho'l", "Paxtakor", "Yangiobod", "Zomin", "Zafarobod"],
            "Sirdaryo": ["Guliston shahri", "Boyovut", "Oqoltin", "Sayxunobod", "Sardoba", "Sirdaryo shahri", "Xovos", "Yangiyer"],
            "Qoraqalpog'iston": ["Nukus shahri", "Amudaryo", "Beruniy", "Chimboy", "Ellikqal'a", "Kegeyli", "Mo'ynoq", "Nukus tumani", "Qonliko'l", "Qo'ng'irot", "Shumanay", "Taxtako'pir", "To'rtko'l", "Xo'jayli"]
        };

        // ===== DASTLABKI MAHSULOTLAR =====
        const sampleProducts = [{
            id: 1,
            name: "Nike Air Max 270",
            price: 450000,
            category: "Oyoq kiyimlar",
            description: "Nike Air Max 270 - bu eng yangi va qulay kundalik krossovkalar. Havoni his qilish uchun maxsus tayyorlangan.",
            image: "rasm.png"
        }, {
            id: 2,
            name: "Adidas T-shirt",
            price: 120000,
            category: "Kiyimlar",
            description: "100% paxtadan tayyorlangan, nafas oladigan Adidas futbolka. Kundalik foydalanish uchun juda qulay.",
            image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8dHNoaXJ0fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
        }, {
            id: 3,
            name: "iPhone 14 Pro",
            price: 8500000,
            category: "Elektronika",
            description: "Apple iPhone 14 Pro - eng yangi texnologiyalar bilan jihozlangan smartfon. 256GB xotira, 48MP asosiy kamera.",
            image: "https://images.unsplash.com/photo-1664478546384-d57ffe74a78c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aXBob25lJTIwMTR8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
        }, {
            id: 4,
            name: "Samsung 55\" 4K Smart TV",
            price: 3500000,
            category: "Elektronika",
            description: "Samsung 55 dyumli 4K Smart TV. Crystal Processor 4K, HDR10+, Smart TV platformasi.",
            image: "https://images.unsplash.com/photo-1593359677879-a4bb92f829d1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8dHZ8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
        }, {
            id: 5,
            name: "Uy pardasi to'plami",
            price: 250000,
            category: "Uy-ro'zg'or",
            description: "3 donadan iborat uy pardasi to'plami. 100% paxta, yuvilganda bo'shlashtirmaydi, ranglari o'chmaydi.",
            image: "https://images.unsplash.com/photo-1556228578-9c360e1d8d34?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YmVkc2hlZXRzfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
        }, {
            id: 6,
            name: "Chanel Chance Parfum",
            price: 180000,
            category: "Go'zallik",
            description: "Chanel Chance parfyumeriyasi - yangi va jozibali hid. 50ml, original Fransiyadan.",
            image: "https://images.unsplash.com/photo-1541643600914-78b084683601?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cGVyZnVtZXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"
        }, {
            id: 7,
            name: "Levi's Jeans",
            price: 220000,
            category: "Kiyimlar",
            description: "Levi's 501 klassik jeans. 100% paxta, amerikancha uslubda tayyorlangan.",
            image: "https://images.unsplash.com/photo-1542272604-787c3835535d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8amVhbnN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
        }, {
            id: 8,
            name: "Samsung Galaxy S23",
            price: 7200000,
            category: "Elektronika",
            description: "Samsung Galaxy S23 Ultra - 200MP kamera, 8K video yozish, Snapdragon 8 Gen 2 protsessori.",
            image: "https://images.unsplash.com/photo-1678911820854-35c8b0e20949?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8c2Ftc3VuZyUyMHMyM3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"
        }];

        // ===== ASOSIY FUNKSIYALAR =====

        // Dasturni boshlash
        function startApp() {
            const userName = document.getElementById('userName').value.trim();

            if (!userName) {
                showNotification("Iltimos, ismingizni kiriting!", "error");
                return;
            }

            // Foydalanuvchini saqlash
            currentUser = {
                name: userName,
                phone: "",
                email: "",
                loyaltyPoints: 0
            };

            // Sahifalarni ko'rsatish
            document.getElementById('loginPage').classList.remove('active');
            document.getElementById('mainHeader').style.display = 'block';
            document.getElementById('searchContainer').style.display = 'block';
            document.getElementById('bottomNav').style.display = 'flex';

            // Foydalanuvchi ma'lumotlarini ko'rsatish
            updateUserDisplay();

            // Bosh sahifaga o'tish
            showHome();

            // Viloyatlarni ro'yxatga kiritish
            populateRegions();

            showNotification(`Xush kelibsiz, ${userName}!`, "success");
        }

        // Foydalanuvchi ma'lumotlarini yangilash
        function updateUserDisplay() {
            if (!currentUser) return;

            document.getElementById('currentUserName').textContent = currentUser.name;
            document.getElementById('profileUserName').textContent = currentUser.name;
            document.getElementById('checkoutUserName').textContent = currentUser.name;
            document.getElementById('confirmationUserName').textContent = currentUser.name;

            if (currentUser.phone) {
                document.getElementById('profileUserPhone').textContent = currentUser.phone;
                document.getElementById('checkoutUserPhone').textContent = currentUser.phone;
                document.getElementById('userPhone').value = currentUser.phone;
            }
        }

        // Sahifani almashtirish
        function switchPage(pageId) {
            // Oldingi sahifani eslab qolish
            if (pageId !== 'profilePage' && pageId !== 'homePage' &&
                pageId !== 'catalogPage' && pageId !== 'cartPage') {
                lastPage = pageId;
            }

            // Barcha sahifalarni yashirish
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });

            // Tanlangan sahifani ko'rsatish
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }

            // Navigatsiya tugmalarini yangilash
            updateNavigation(pageId);
        }

        // Navigatsiyani yangilash
        function updateNavigation(pageId) {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));

            // Asosiy sahifalar uchun
            if (pageId === 'homePage') {
                navItems[0].classList.add('active');
            } else if (pageId === 'catalogPage') {
                navItems[1].classList.add('active');
            } else if (pageId === 'cartPage') {
                navItems[2].classList.add('active');
            } else if (pageId === 'profilePage' ||
                pageId === 'ordersPage' ||
                pageId === 'favoritesPage' ||
                pageId === 'viewedPage' ||
                pageId === 'addressesPage' ||
                pageId === 'loyaltyPage') {
                navItems[3].classList.add('active');
            }
        }

        // Orqaga qaytish
        function goBack() {
            if (lastPage === 'profilePage' || lastPage === 'homePage' ||
                lastPage === 'catalogPage' || lastPage === 'cartPage') {
                switchPage(lastPage);
            } else {
                switchPage('profilePage');
            }
        }

        // Asosiy sahifalar uchun funksiyalar
        function showHome() {
            switchPage('homePage');
            lastPage = 'homePage';
        }

        function showCatalog() {
            switchPage('catalogPage');
            loadCatalog('all');
            lastPage = 'catalogPage';
        }

        function showCart() {
            switchPage('cartPage');
            updateCart();
            lastPage = 'cartPage';
        }

        function showProfile() {
            switchPage('profilePage');
            lastPage = 'profilePage';
        }

        // Kategoriyani ko'rsatish
        function showCategory(category) {
            switchPage('catalogPage');
            loadCatalog(category);
            lastPage = 'catalogPage';
        }

        // Katalog yuklash
        function loadCatalog(category) {
            currentCategory = category;
            const productGrid = document.getElementById('productGrid');
            const catalogTitle = document.getElementById('catalogTitle');

            // Sarlavhani yangilash
            if (category === 'all') {
                catalogTitle.textContent = "Barcha mahsulotlar";
            } else {
                catalogTitle.textContent = category;
            }

            // Mahsulotlarni filtrlash
            let filteredProducts = sampleProducts;
            if (category !== 'all') {
                filteredProducts = sampleProducts.filter(product => product.category === category);
            }

            // Mahsulotlarni chiqarish
            productGrid.innerHTML = '';
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => showProductDetail(product.id);
                productCard.innerHTML = `
                    <div class="product-image" style="background-image: url('${product.image}')">
                        <i class="fas fa-box" style="display: none;"></i>
                    </div>
                    <div class="product-info">
                        <div class="product-title">${product.name}</div>
                        <div class="product-price">${product.price.toLocaleString()} so'm</div>
                        <div class="product-actions">
                            <button class="btn btn-outline" onclick="event.stopPropagation(); addToCart(${product.id})">
                                <i class="fas fa-cart-plus"></i> Savatchaga
                            </button>
                            <button class="btn btn-primary" onclick="event.stopPropagation(); showProductDetail(${product.id})">
                                <i class="fas fa-eye"></i> Ko'rish
                            </button>
                        </div>
                    </div>
                `;
                productGrid.appendChild(productCard);
            });

            // Agar mahsulot yo'q bo'lsa
            if (filteredProducts.length === 0) {
                productGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--gray);">
                        <i class="fas fa-box-open" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <div>Bu kategoriyada hali mahsulotlar yo'q</div>
                    </div>
                `;
            }
        }

        // Mahsulot tafsilotlarini ko'rsatish
        function showProductDetail(productId) {
            const product = sampleProducts.find(p => p.id === productId);
            if (!product) return;

            document.getElementById('productDetailImage').innerHTML = `
                <div style="background-image: url('${product.image}'); width: 100%; height: 100%; background-size: cover; background-position: center;"></div>
            `;
            document.getElementById('productDetailName').textContent = product.name;
            document.getElementById('productDetailPrice').textContent = `${product.price.toLocaleString()} so'm`;
            document.getElementById('productDetailCategory').textContent = product.category;
            document.getElementById('productDetailDesc').textContent = product.description;

            // Mahsulot ID ni saqlash
            document.getElementById('productDetailImage').dataset.productId = productId;

            switchPage('productDetailPage');
            lastPage = 'catalogPage';
        }

        // Savatchaga qo'shish (umumiy)
        function addToCart(productId) {
            const product = sampleProducts.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);

            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1,
                    image: product.image
                });
            }

            updateCart();
            showNotification("Mahsulot savatchaga qo'shildi!", "success");
        }

        // Tafsilotlar sahifasidan savatchaga qo'shish
        function addToCartFromDetail() {
            const productId = parseInt(document.getElementById('productDetailImage').dataset.productId);
            addToCart(productId);
        }

        // Savatni yangilash
        function updateCart() {
            const cartItems = document.getElementById('cartItems');
            const totalPriceElement = document.getElementById('totalPrice');

            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: var(--gray);">
                        <i class="fas fa-shopping-cart" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <div>Savatda hali mahsulot yo'q</div>
                    </div>
                `;
                totalPriceElement.textContent = "0 so'm";
                return;
            }

            let totalPrice = 0;
            cartItems.innerHTML = '';

            cart.forEach(item => {
                totalPrice += item.price * item.quantity;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-image" style="background-image: url('${item.image}')">
                        <i class="fas fa-box" style="display: none;"></i>
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-title">${item.name}</div>
                        <div class="cart-item-price">${(item.price * item.quantity).toLocaleString()} so'm</div>
                        <div class="cart-item-actions">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            totalPriceElement.textContent = `${totalPrice.toLocaleString()} so'm`;
        }

        // Miqdorni o'zgartirish
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);

            if (item) {
                item.quantity += change;

                if (item.quantity <= 0) {
                    cart = cart.filter(item => item.id !== productId);
                }

                updateCart();
            }
        }

        // ===== BUYURTMA BERISH =====

        // Buyurtma sahifasini ko'rsatish
        function showCheckoutPage() {
            if (cart.length === 0) {
                showNotification("Iltimos, avval mahsulot qo'shing!", "error");
                return;
            }

            // Mahsulotlarni ko'rsatish
            const checkoutItems = document.getElementById('checkoutItems');
            let totalPrice = 0;

            checkoutItems.innerHTML = '';
            cart.forEach(item => {
                totalPrice += item.price * item.quantity;

                const itemDiv = document.createElement('div');
                itemDiv.className = 'menu-item';
                itemDiv.innerHTML = `
                    <div>${item.name} √ó ${item.quantity}</div>
                    <div>${(item.price * item.quantity).toLocaleString()} so'm</div>
                `;
                checkoutItems.appendChild(itemDiv);
            });

            // Umumiy summani ko'rsatish
            document.getElementById('checkoutTotal').textContent = `${totalPrice.toLocaleString()} so'm`;

            // Telefon raqamni o'rnatish
            if (currentUser && currentUser.phone) {
                document.getElementById('userPhone').value = currentUser.phone;
            } else {
                document.getElementById('userPhone').value = '';
            }

            switchPage('checkoutPage');
        }

        // Viloyatlarni ro'yxatga kiritish
        function populateRegions() {
            const regionSelect = document.getElementById('regionSelect');
            const modalRegionSelect = document.getElementById('modalRegionSelect');

            regionSelect.innerHTML = '<option value="">Viloyatni tanlang</option>';
            modalRegionSelect.innerHTML = '<option value="">Viloyatni tanlang</option>';

            Object.keys(regions).forEach(region => {
                regionSelect.innerHTML += `<option value="${region}">${region}</option>`;
                modalRegionSelect.innerHTML += `<option value="${region}">${region}</option>`;
            });
        }

        // Tumanlarni yangilash
        function updateDistricts() {
            const regionSelect = document.getElementById('regionSelect');
            const districtSelect = document.getElementById('districtSelect');

            const selectedRegion = regionSelect.value;

            if (selectedRegion && regions[selectedRegion]) {
                districtSelect.disabled = false;
                districtSelect.innerHTML = '<option value="">Tuman/Shaharni tanlang</option>';

                regions[selectedRegion].forEach(district => {
                    districtSelect.innerHTML += `<option value="${district}">${district}</option>`;
                });
            } else {
                districtSelect.disabled = true;
                districtSelect.innerHTML = '<option value="">Avval viloyatni tanlang</option>';
            }
        }

        // Modal uchun tumanlarni yangilash
        function updateModalDistricts() {
            const modalRegionSelect = document.getElementById('modalRegionSelect');
            const modalDistrictSelect = document.getElementById('modalDistrictSelect');

            const selectedRegion = modalRegionSelect.value;

            if (selectedRegion && regions[selectedRegion]) {
                modalDistrictSelect.disabled = false;
                modalDistrictSelect.innerHTML = '<option value="">Tuman/Shaharni tanlang</option>';

                regions[selectedRegion].forEach(district => {
                    modalDistrictSelect.innerHTML += `<option value="${district}">${district}</option>`;
                });
            } else {
                modalDistrictSelect.disabled = true;
                modalDistrictSelect.innerHTML = '<option value="">Avval viloyatni tanlang</option>';
            }
        }

        // Buyurtmani yuborish
        async function submitOrder() {
            // Ma'lumotlarni tekshirish
            const region = document.getElementById('regionSelect').value;
            const district = document.getElementById('districtSelect').value;
            const fullAddress = document.getElementById('fullAddress').value.trim();
            const userPhone = document.getElementById('userPhone').value.trim();
            const orderComment = document.getElementById('orderComment').value.trim();
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;

            // Validatsiya
            if (!region) {
                showNotification("Iltimos, viloyatni tanlang!", "error");
                return;
            }

            if (!district) {
                showNotification("Iltimos, tuman/shaharni tanlang!", "error");
                return;
            }

            if (!fullAddress) {
                showNotification("Iltimos, to'liq manzilni kiriting!", "error");
                return;
            }

            if (!userPhone) {
                showNotification("Iltimos, telefon raqamingizni kiriting!", "error");
                return;
            }

            // Telefon raqamni tekshirish
            const phoneRegex = /^\+998\d{9}$/;
            if (!phoneRegex.test(userPhone)) {
                showNotification("Iltimos, to'g'ri telefon raqam kiriting (+998901234567 formatida)", "error");
                return;
            }

            // Yuklanmoqda bildirishnomasini ko'rsatish
            showNotification("Buyurtma yuborilmoqda...", "warning");

            // Buyurtma ma'lumotlarini tayyorlash
            let orderItems = '';
            let totalAmount = 0;

            cart.forEach(item => {
                orderItems += `‚Ä¢ ${item.name} - ${item.quantity} x ${item.price.toLocaleString()} = ${(item.price * item.quantity).toLocaleString()} so'm\n`;
                totalAmount += item.price * item.quantity;
            });

            // Telegramga yuborish uchun xabar
            const message = `
üõí YANGI BUYURTMA

üë§ Mijoz: ${currentUser.name}
üìû Telefon: ${userPhone}

üìç Manzil:
Viloyat: ${region}
Tuman: ${district}
To'liq manzil: ${fullAddress}

üì¶ Mahsulotlar:
${orderItems}

üí∞ Umumiy summa: ${totalAmount.toLocaleString()} so'm
üí≥ To'lov usuli: ${getPaymentMethodName(paymentMethod)}
üìù Izoh: ${orderComment || "Yo'q"}

‚è∞ Buyurtma vaqti: ${new Date().toLocaleString('uz-UZ')}
    `;

            // Telegram botga xabar yuborish
            try {
                const response = await sendToTelegram(message);

                if (response.ok) {
                    // Muvaffaqiyatli yuborilgandan keyin
                    currentOrder = {
                        id: Date.now(),
                        date: new Date().toLocaleString('uz-UZ'),
                        customerName: currentUser.name,
                        customerPhone: userPhone,
                        region: region,
                        district: district,
                        address: fullAddress,
                        items: [...cart],
                        totalAmount: totalAmount,
                        paymentMethod: paymentMethod,
                        comment: orderComment,
                        status: "Yangi"
                    };

                    // Foydalanuvchi telefon raqamini saqlash
                    currentUser.phone = userPhone;
                    updateUserDisplay();

                    // Loyallik ballarini hisoblash (har 10,000 so'm uchun 1 ball)
                    const newPoints = Math.floor(totalAmount / 10000);
                    currentUser.loyaltyPoints += newPoints;
                    document.getElementById('loyaltyPoints').textContent = currentUser.loyaltyPoints;
                    document.getElementById('loyaltyPointsDisplay').textContent = `${currentUser.loyaltyPoints} ball`;

                    // Savatni tozalash
                    cart = [];
                    updateCart();

                    // Telegramga yuborilganidan keyin tasdiq xabarini ko'rsatish
                    showNotification("Ma'lumotlaringiz qabul qilindi. Tez orada sizga aloqaga chiqishadi!", "success");

                    // Buyurtma tasdiq sahifasiga o'tish
                    showOrderConfirmation();

                } else {
                    throw new Error('Telegram API xatosi');
                }

            } catch (error) {
                console.error("Xatolik:", error);
                showNotification("Buyurtma yuborishda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.", "error");
            }
        }

        // Telegram botga xabar yuborish
        async function sendToTelegram(message) {
            const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });

                const data = await response.json();

                return {
                    ok: data.ok,
                    data: data
                };
            } catch (error) {
                console.error("Fetch xatosi:", error);
                return {
                    ok: false,
                    error: error
                };
            }
        }

        // To'lov usulini nomini olish
        function getPaymentMethodName(method) {
            const methods = {
                'cash': 'Naqd pul',
                'card': 'Bank kartasi',
                'click': 'Click',
                'payme': 'Payme'
            };
            return methods[method] || method;
        }

        // Buyurtma tasdiq sahifasini ko'rsatish
        function showOrderConfirmation() {
            if (!currentOrder) return;

            document.getElementById('orderNumber').textContent = `#${currentOrder.id.toString().slice(-6)}`;
            document.getElementById('summaryTotal').textContent = `${currentOrder.totalAmount.toLocaleString()} so'm`;
            document.getElementById('summaryAddress').textContent = `${currentOrder.region}, ${currentOrder.district}`;

            switchPage('orderConfirmationPage');
        }

        // Xaridni davom ettirish
        function continueShopping() {
            showHome();
        }

        function viewOrders() {
            showOrders();
        }

        // ===== PROFIL FUNKSIYALARI =====

        // Profilni tahrirlash
        function editProfile() {
            if (!currentUser) return;

            document.getElementById('editPhone').value = currentUser.phone || '';
            document.getElementById('editEmail').value = currentUser.email || '';
            openModal('profileModal');
        }

        // Profilni saqlash
        function saveProfile() {
            const phone = document.getElementById('editPhone').value.trim();
            const email = document.getElementById('editEmail').value.trim();

            // Telefon raqamni tekshirish
            if (phone && !phone.match(/^\+998\d{9}$/)) {
                showNotification("Iltimos, to'g'ri telefon raqam kiriting!", "error");
                return;
            }

            currentUser.phone = phone;
            currentUser.email = email;

            updateUserDisplay();
            closeModal('profileModal');
            showNotification("Profil ma'lumotlari yangilandi!", "success");
        }

        // Ismni o'zgartirish
        function changeName() {
            if (!currentUser) return;

            document.getElementById('newUserName').value = currentUser.name;
            openModal('nameModal');
        }

        // Yangi ismni saqlash
        function saveNewName() {
            const newName = document.getElementById('newUserName').value.trim();

            if (!newName) {
                showNotification("Iltimos, yangi ism kiriting!", "error");
                return;
            }

            currentUser.name = newName;
            updateUserDisplay();
            closeModal('nameModal');
            showNotification("Ism muvaffaqiyatli o'zgartirildi!", "success");
        }

        // Manzillar ro'yxatini ko'rsatish
        function showAddresses() {
            switchPage('addressesPage');
            updateAddressesList();
        }

        // Manzillar ro'yxatini yangilash
        function updateAddressesList() {
            // Hozircha oddiy sahifa, kelajakda saqlangan manzillar bo'lishi mumkin
        }

        // Manzil qo'shish
        function openAddAddress() {
            openModal('addressModal');
        }

        // Manzilni saqlash
        function saveAddress() {
            const name = document.getElementById('addressName').value.trim();
            const region = document.getElementById('modalRegionSelect').value;
            const district = document.getElementById('modalDistrictSelect').value;
            const fullAddress = document.getElementById('modalFullAddress').value.trim();

            if (!name || !region || !district || !fullAddress) {
                showNotification("Iltimos, barcha maydonlarni to'ldiring!", "error");
                return;
            }

            // Manzilni saqlash (kelajakda ma'lumotlar bazasiga saqlanishi mumkin)
            const newAddress = {
                name: name,
                region: region,
                district: district,
                address: fullAddress
            };

            showNotification("Yangi manzil qo'shildi!", "success");
            closeModal('addressModal');

            // Formani tozalash
            document.getElementById('addressName').value = '';
            document.getElementById('modalRegionSelect').value = '';
            document.getElementById('modalDistrictSelect').value = '';
            document.getElementById('modalDistrictSelect').disabled = true;
            document.getElementById('modalFullAddress').value = '';
        }

        // Buyurtmalarni ko'rsatish
        function showOrders() {
            switchPage('ordersPage');
        }

        // Sevimlilarni ko'rsatish
        function showFavorites() {
            switchPage('favoritesPage');
        }

        // Ko'rilganlarni ko'rsatish
        function showViewed() {
            switchPage('viewedPage');
        }

        // Loyallik dasturini ko'rsatish
        function showLoyalty() {
            if (currentUser) {
                document.getElementById('loyaltyPointsDisplay').textContent = `${currentUser.loyaltyPoints || 0} ball`;
            }
            switchPage('loyaltyPage');
        }

        // Chiqish
        function logout() {
            if (confirm("Haqiqatan ham chiqmoqchimisiz?")) {
                // Ma'lumotlarni tozalash
                currentUser = null;
                cart = [];

                // Kirish sahifasiga qaytish
                document.getElementById('loginPage').classList.add('active');
                document.getElementById('mainHeader').style.display = 'none';
                document.getElementById('searchContainer').style.display = 'none';
                document.getElementById('bottomNav').style.display = 'none';

                // Boshqa sahifalarni yashirish
                switchPage('homePage');

                // Formani tozalash
                document.getElementById('userName').value = '';

                showNotification("Siz tizimdan chiqdingiz", "success");
            }
        }

        // ===== UMUMIY FUNKSIYALAR =====

        // Modal ochish
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        // Modal yopish
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Xabarlarni ko'rsatish
        function showNotification(message, type = "success") {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');

            notificationText.textContent = message;

            // Oldingi klasslarni olib tashlash
            notification.classList.remove('error', 'warning', 'success');

            // Yangi klass qo'shish
            if (type === "error") {
                notification.classList.add('error');
            } else if (type === "warning") {
                notification.classList.add('warning');
            } else {
                notification.classList.add('success');
            }

            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000); // 5 soniya
        }

        // ===== DASTLABKI SOZLAMALAR =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Magicbot do'koni yuklandi!");

            // Qidiruv funksiyasi
            document.getElementById('searchInput').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();

                if (searchTerm.length > 2) {
                    const filtered = sampleProducts.filter(product =>
                        product.name.toLowerCase().includes(searchTerm) ||
                        product.category.toLowerCase().includes(searchTerm) ||
                        product.description.toLowerCase().includes(searchTerm)
                    );

                    if (document.getElementById('catalogPage').classList.contains('active')) {
                        loadSearchResults(filtered);
                    }
                } else if (searchTerm.length === 0 && document.getElementById('catalogPage').classList.contains('active')) {
                    loadCatalog(currentCategory);
                }
            });
        });

        // Qidiruv natijalarini ko'rsatish
        function loadSearchResults(filteredProducts) {
            const productGrid = document.getElementById('productGrid');
            const catalogTitle = document.getElementById('catalogTitle');

            catalogTitle.textContent = `Qidiruv natijalari (${filteredProducts.length})`;

            productGrid.innerHTML = '';
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => showProductDetail(product.id);
                productCard.innerHTML = `
                    <div class="product-image" style="background-image: url('${product.image}')">
                        <i class="fas fa-box" style="display: none;"></i>
                    </div>
                    <div class="product-info">
                        <div class="product-title">${product.name}</div>
                        <div class="product-price">${product.price.toLocaleString()} so'm</div>
                        <div class="product-actions">
                            <button class="btn btn-outline" onclick="event.stopPropagation(); addToCart(${product.id})">
                                <i class="fas fa-cart-plus"></i> Savatchaga
                            </button>
                            <button class="btn btn-primary" onclick="event.stopPropagation(); showProductDetail(${product.id})">
                                <i class="fas fa-eye"></i> Ko'rish
                            </button>
                        </div>
                    </div>
                `;
                productGrid.appendChild(productCard);
            });

            if (filteredProducts.length === 0) {
                productGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--gray);">
                        <i class="fas fa-search" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <div>"${document.getElementById('searchInput').value}" uchun hech narsa topilmadi</div>
                    </div>
                `;
            }
        }
    </script>
</body>

</html>